process {
    withName: 'SEQERA_RUNS_DUMP' {
        ext.args = { params.seqera_cli_extra_args ? params.seqera_cli_extra_args.split("\\s(?=--)") : '' }
        ext.args2 = { params.skip_run_gantt ? '' : '--add-task-logs' }
        publishDir = [
            path: { "${params.outdir}/${metaOut?.projectName?.replace("/", "_") ?: ""}/runs_dump" },
            mode: params.publish_dir_mode,
            saveAs: { filename -> filename.equals('versions.yml') || filename.endsWith('.json') ? null : filename }
        ]
    }
}

profiles {
    docker            { process.withName: 'SEQERA_RUNS_DUMP' { container = 'tower-cli:0.9.2--dc544a7e574ab73b' } }
    docker_arm64      { process.withName: 'SEQERA_RUNS_DUMP' { container = 'tower-cli:0.9.2--104eab7c00912b48' } }
    singularity       { process.withName: 'SEQERA_RUNS_DUMP' { container = 'tower-cli:0.9.2--810270aea7c40770' } }
    singularity_arm64 { process.withName: 'SEQERA_RUNS_DUMP' { container = 'tower-cli:0.9.2--23fa648bc78102d6' } }
}
